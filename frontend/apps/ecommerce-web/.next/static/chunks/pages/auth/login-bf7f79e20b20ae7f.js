(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[384],{2644:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return s(6953)}])},6316:(e,t,s)=>{e.exports=s(5938)},6953:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(72),a=s(4),l=s(983),n=s(7698),i=s.n(n),o=s(6316),c=s.n(o),d=s(1835),m=s(3636),x=s(5570);let h=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}),u=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});var g=s(8939),f=s(3644),p=s(1180),b=s(6340),y=s(5565),j=s(9852);let v=e=>{let{isOpen:t,onClose:s,onSelect:l}=e,{branches:n,selectedBranch:i,userLocation:o,isLoadingLocation:c,detectLocation:m,fetchBranches:h,calculateDistance:u,setSelectedBranch:g}=(0,f.x)(),[v,w]=(0,a.useState)(""),[N,k]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&h()},[t,h]),(0,a.useEffect)(()=>{let e=n.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())||e.city.toLowerCase().includes(v.toLowerCase())||e.address.toLowerCase().includes(v.toLowerCase()));o&&e.sort((e,t)=>(u(e)||1/0)-(u(t)||1/0)),k(e)},[n,v,o,u]);let C=async()=>{try{await m()}catch(e){console.error("Failed to detect location:",e)}},L=e=>{g(e),l(e),s()},S=e=>{let t=u(e);return null===t?"":t<1?"".concat(Math.round(1e3*t),"m"):"".concat(t.toFixed(1),"km")};return(0,r.jsx)(p.N,{children:t&&(0,r.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:s,children:(0,r.jsxs)(d.P.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Select Your Branch"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsxs)("button",{onClick:C,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,r.jsx)(x.A,{className:"w-4 h-4"}),c?"Detecting...":"Use My Location"]}),o&&(0,r.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"\uD83D\uDCCD Location detected - showing nearest branches"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(b.A,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search by branch name, city, or area...",value:v,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),(0,r.jsx)("div",{className:"p-6 max-h-96 overflow-y-auto",children:0===N.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:v?"No branches found matching your search.":"Loading branches..."}):(0,r.jsx)("div",{className:"space-y-3",children:N.map(e=>(0,r.jsx)(d.P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>L(e),className:"p-4 border rounded-xl cursor-pointer transition-all ".concat((null==i?void 0:i.id)===e.id?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-gray-200 hover:border-green-300 hover:bg-gray-50"),children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),o&&(0,r.jsxs)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[S(e)," away"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-600 mb-2",children:[(0,r.jsx)(x.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:[e.address,", ",e.city,", ",e.state]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.workingHours&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(y.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:e.workingHours.isOpen24Hours?"24 Hours":"".concat(e.workingHours.open," - ").concat(e.workingHours.close)})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:[e.deliveryRadius,"km delivery"]})]})]}),e.features&&e.features.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.features.slice(0,3).map((e,t)=>(0,r.jsx)("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full",children:e},t))})]}),(null==i?void 0:i.id)===e.id&&(0,r.jsx)("div",{className:"ml-4",children:(0,r.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]})},e.id))})}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[N.length," branch",1!==N.length?"es":""," ","available"]}),i&&(0,r.jsxs)("button",{onClick:()=>L(i),className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:["Continue with ",i.name]})]})})]})})})};var w=s(8033);function N(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[o,p]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!0),[j,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),[L,S]=(0,a.useState)(!1),{user:_}=(0,g.n)(),{selectedBranch:E,fetchBranches:A,detectLocation:P,branches:H}=(0,f.x)(),M=(0,l.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("leafy_remembered_email"),s="true"===localStorage.getItem("leafy_remember_me");e&&s?(t(e),y(!0)):(t("customer@leafyhealth.com"),n("password123"));try{await P()}catch(e){console.log("Location detection failed, loading all branches"),await A()}}catch(e){console.error("Login initialization error:",e)}})()},[]),(0,a.useEffect)(()=>{if(_){let e=M.query.returnUrl||"/customer";M.push(e)}},[_,M]);let B=async t=>{t.preventDefault(),N(!0),C("");try{console.log("Customer login attempt for:",e);let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s,branchId:null==E?void 0:E.id})}),r=await t.json();if(r.success){console.log("Login successful:",r);let t=g.n.getState();t.setUser(r.user),t.setToken(r.token),t.setAuthenticated(!0),b?(localStorage.setItem("leafy_remembered_email",e),localStorage.setItem("leafy_remember_me","true")):(localStorage.removeItem("leafy_remembered_email"),localStorage.removeItem("leafy_remember_me"));let s=M.query.returnUrl||"/account";console.log("Redirecting to:",s),M.push(s)}else C(r.message||"Login failed. Please check your credentials.")}catch(e){console.error("Login error:",e),C("Network error. Please try again.")}finally{N(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:"Customer Login - LeafyHealth"}),(0,r.jsx)("meta",{name:"description",content:"Sign in to your LeafyHealth account for organic grocery delivery"})]}),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-emerald-50 flex items-center justify-center px-4 py-8",children:(0,r.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:[(0,r.jsxs)(w.A,{className:"p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)(m.A,{className:"w-8 h-8 text-green-600"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Sign in to continue your organic shopping journey"}),E&&(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-center text-sm text-gray-500",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-1"}),(0,r.jsxs)("span",{children:["Shopping from ",E.name]})]})]}),k&&(0,r.jsx)(d.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-600 text-sm",children:k})}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("button",{type:"button",onClick:()=>S(!0),className:"w-full p-4 bg-green-50 hover:bg-green-100 border border-green-200 rounded-lg transition-colors text-left",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-green-800 text-sm font-medium mb-1",children:E?"Selected Branch:":"Select Your Branch"}),E?(0,r.jsxs)("div",{className:"text-green-700 text-xs space-y-1",children:[(0,r.jsx)("div",{className:"font-medium",children:E.name}),(0,r.jsxs)("div",{children:[E.city,", ",E.state]})]}):(0,r.jsx)("div",{className:"text-green-600 text-xs",children:"Choose your nearest branch for delivery"})]}),(0,r.jsx)("div",{className:"flex items-center text-green-600",children:(0,r.jsx)(x.A,{className:"w-5 h-5"})})]})})}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsx)("p",{className:"text-blue-800 text-sm font-medium mb-2",children:"Demo Login Credentials:"}),(0,r.jsxs)("div",{className:"text-blue-700 text-xs space-y-1",children:[(0,r.jsx)("div",{children:"Email: customer@leafyhealth.com"}),(0,r.jsx)("div",{children:"Password: password123"})]})]}),(0,r.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,r.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"Enter your email",required:!0,autoComplete:"email"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{id:"password",type:o?"text":"password",value:s,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent pr-12 transition-colors",placeholder:"Enter your password",required:!0,autoComplete:"current-password"}),(0,r.jsx)("button",{type:"button",onClick:()=>p(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:o?(0,r.jsx)(h,{className:"w-5 h-5"}):(0,r.jsx)(u,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{id:"remember-me",type:"checkbox",checked:b,onChange:e=>y(e.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),(0,r.jsx)(i(),{href:"/auth/forgot-password",className:"text-sm text-green-600 hover:text-green-700",children:"Forgot password?"})]}),(0,r.jsx)(d.P.button,{type:"submit",disabled:j,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium shadow-lg",children:j?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign In"})]}),(0,r.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"New to LeafyHealth?"})})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(i(),{href:"/auth/register",className:"inline-flex items-center justify-center w-full px-4 py-3 border border-green-600 text-green-600 rounded-lg hover:bg-green-50 transition-colors font-medium",children:"Create Account"})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(i(),{href:"/customer",className:"text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"Continue as guest"})})]})]}),!E&&H.length>0&&(0,r.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-4 text-center",children:(0,r.jsx)(i(),{href:"/customer",className:"text-sm text-green-600 hover:text-green-700",children:"Select your delivery location first"})})]})}),(0,r.jsx)(v,{isOpen:L,onClose:()=>S(!1),onSelect:e=>{console.log("Branch selected:",e),S(!1)}})]})}},9852:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(4);let a=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))})}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(2644)),_N_E=e.O()}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4230],{163:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(5935).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},347:(e,t,a)=>{a.d(t,{BT:()=>n,Wu:()=>d,ZB:()=>o,Zp:()=>r,aR:()=>l});var s=a(72);a(4);let r=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"bg-white border rounded-lg shadow ".concat(a),children:t})},l=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"px-6 py-4 border-b ".concat(a),children:t})},o=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("h3",{className:"text-lg font-semibold ".concat(a),children:t})},n=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1 ".concat(a),children:t})},d=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"px-6 py-4 ".concat(a),children:t})}},402:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(5935).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},1703:(e,t,a)=>{a.d(t,{p:()=>r});var s=a(72);let r=a(4).forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("input",{ref:t,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed ".concat(a),...r})});r.displayName="Input"},3413:(e,t,a)=>{a.d(t,{$:()=>r});var s=a(72);let r=a(4).forwardRef((e,t)=>{let{children:a,className:r="",size:l="md",variant:o="default",...n}=e;return(0,s.jsx)("button",{ref:t,className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[l]," ").concat({default:"bg-blue-600 text-white hover:bg-blue-700",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",destructive:"bg-red-600 text-white hover:bg-red-700"}[o]," disabled:opacity-50 disabled:cursor-not-allowed ").concat(r),...n,children:a})});r.displayName="Button"},4206:(e,t,a)=>{a.d(t,{E:()=>r});var s=a(72);a(4);let r=e=>{let{children:t,variant:a="default",className:r=""}=e;return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({default:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",destructive:"bg-red-100 text-red-800"}[a]," ").concat(r),children:t})}},4230:(e,t,a)=>{a.d(t,{A:()=>f});var s=a(72),r=a(4),l=a(347),o=a(3413),n=a(1703),d=a(4206),i=a(402),c=a(6383),u=a(163),m=a(7101),p=a(7937),x=a(6790);function f(){var e;let[t,a]=(0,r.useState)([]),[f,h]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),[j,b]=(0,r.useState)(""),[v,N]=(0,r.useState)("all"),[w,k]=(0,r.useState)("all"),[A,C]=(0,r.useState)(null),[S,E]=(0,r.useState)(!1),[z,F]=(0,r.useState)(!1);(0,r.useEffect)(()=>{P()},[j,v,w]);let P=async()=>{try{let e,t;y(!0);let s=0;for(;s<5;)try{if((e=await fetch("/api/products",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok)break;if(502===e.status){console.log("Service unavailable, retrying in 3 seconds... (attempt ".concat(s+1,"/").concat(5,")")),await new Promise(e=>setTimeout(e,3e3)),s++;continue}break}catch(e){if(console.error("Fetch attempt ".concat(s+1," failed:"),e),4===s)throw e;await new Promise(e=>setTimeout(e,3e3)),s++}if(e&&e.ok){let t=await e.json();console.log("Products data received:",t),Array.isArray(t)?a(t):t&&t.data&&Array.isArray(t.data)?a(t.data):(console.warn("Unexpected products data format:",t),a([]))}else console.error("Failed to fetch products after retries"),a([]);for(s=0;s<5;)try{if((t=await fetch("/api/categories",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok)break;if(502===t.status){console.log("Categories service unavailable, retrying in 3 seconds... (attempt ".concat(s+1,"/").concat(5,")")),await new Promise(e=>setTimeout(e,3e3)),s++;continue}break}catch(e){if(console.error("Categories fetch attempt ".concat(s+1," failed:"),e),4===s)throw e;await new Promise(e=>setTimeout(e,3e3)),s++}if(t&&t.ok){let e=await t.json();console.log("Categories data received:",e),Array.isArray(e)?h(e):e&&e.data&&Array.isArray(e.data)?h(e.data):(console.warn("Unexpected categories data format:",e),h([]))}else console.error("Failed to fetch categories after retries"),h([])}catch(e){console.error("Failed to fetch data:",e)}finally{y(!1)}},R=async e=>{try{if(!confirm("Are you sure you want to delete this product? This action cannot be undone."))return;console.log("Deleting product:",e);let t=await fetch("/api/products/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete product")}console.log("Product deleted successfully"),await P()}catch(e){console.error("Failed to delete product:",e),alert("Failed to delete product: "+(e instanceof Error?e.message:"Unknown error"))}},I=async(e,t)=>{try{console.log("Uploading image for product:",e);let a=new FormData;a.append("files",t),a.append("entityType","product"),a.append("entityId",e.toString());let s=await fetch("/api/image-management/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:a});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to upload image")}console.log("Image uploaded successfully"),await P()}catch(e){console.error("Failed to upload product image:",e),alert("Failed to upload image: "+(e instanceof Error?e.message:"Unknown error"))}},L=t.filter(e=>{let t=e.name.toLowerCase().includes(j.toLowerCase())||e.description.toLowerCase().includes(j.toLowerCase()),a="all"===v||e.category.id.toString()===v,s="all"===w||"active"===w&&e.isActive||"inactive"===w&&!e.isActive;return t&&a&&s});return g?(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:"Loading Product Catalog..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Product Catalog"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Manage your product inventory"})]})}),(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),"Search & Filters"]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)(n.p,{placeholder:"Search products...",value:j,onChange:e=>b(e.target.value)}),(0,s.jsxs)(p.l6,{value:v,onValueChange:N,children:[(0,s.jsx)(p.bq,{children:(0,s.jsx)(p.yv,{placeholder:"Filter by category"})}),(0,s.jsxs)(p.gC,{children:[(0,s.jsx)(p.eb,{value:"all",children:"All Categories"}),f.map(e=>(0,s.jsx)(p.eb,{value:e.id.toString(),children:e.name},e.id))]})]}),(0,s.jsxs)(p.l6,{value:w,onValueChange:k,children:[(0,s.jsx)(p.bq,{children:(0,s.jsx)(p.yv,{placeholder:"Filter by status"})}),(0,s.jsxs)(p.gC,{children:[(0,s.jsx)(p.eb,{value:"all",children:"All Status"}),(0,s.jsx)(p.eb,{value:"active",children:"Active"}),(0,s.jsx)(p.eb,{value:"inactive",children:"Inactive"})]})]})]})})]}),(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)(l.ZB,{children:["Products (",L.length,")"]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Product"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"SKU"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Category"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Price"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Status"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Created"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:L.map(e=>{var t;return(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.images.length>0&&(0,s.jsx)("img",{src:(null==(t=e.images[0])?void 0:t.url)||"/placeholder-product.jpg",alt:e.name,className:"w-10 h-10 rounded-lg object-cover"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:e.description})]})]})}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:e.sku})}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)(d.E,{variant:"secondary",children:e.category.name})}),(0,s.jsxs)("td",{className:"py-3 px-4",children:["â‚¹",e.price]}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)(d.E,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"py-3 px-4",children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.$,{size:"sm",variant:"outline",onClick:()=>{C(e),E(!0)},children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:t=>{var a;let s=null==(a=t.target.files)?void 0:a[0];s&&I(e.id,s)},className:"hidden",id:"image-".concat(e.id)}),(0,s.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>{var t;return null==(t=document.getElementById("image-".concat(e.id)))?void 0:t.click()},children:"Upload Image"}),(0,s.jsxs)(o.$,{size:"sm",variant:"destructive",onClick:()=>R(e.id),children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},e.id)})})]}),0===L.length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No products found matching your filters."})]})})]}),(0,s.jsx)(m.lG,{open:S,onOpenChange:E,children:(0,s.jsx)(m.Cf,{className:"max-w-7xl max-h-[90vh] overflow-y-auto bg-white border border-gray-200 shadow-xl",children:(0,s.jsx)(x.A,{editMode:!0,productId:null==A||null==(e=A.id)?void 0:e.toString(),initialData:A,onSuccess:()=>{E(!1),C(null),P()},onClose:()=>{E(!1),C(null)}})})})]})}},6383:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(5935).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},7101:(e,t,a)=>{a.d(t,{Cf:()=>m,Es:()=>x,L3:()=>f,c7:()=>p,lG:()=>d,rr:()=>h,zM:()=>i});var s=a(72),r=a(4),l=a(9800),o=a(6417),n=a(4018);let d=l.bL,i=l.l9,c=l.ZL;l.bm;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});u.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:a,children:r,...d}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...d,children:[r,(0,s.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="DialogFooter";let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});f.displayName=l.hE.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});h.displayName=l.VY.displayName},7937:(e,t,a)=>{a.d(t,{bq:()=>m,eb:()=>h,gC:()=>f,l6:()=>c,yv:()=>u});var s=a(72),r=a(4),l=a(3677),o=a(3488),n=a(8085),d=a(6478),i=a(4018);let c=l.bL;l.YJ;let u=l.WT,m=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.l9,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,s.jsx)(l.In,{asChild:!0,children:(0,s.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.PP,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=l.PP.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wn,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})});x.displayName=l.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:o="popper",...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsxs)(l.UC,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:o,...n,children:[(0,s.jsx)(p,{}),(0,s.jsx)(l.LM,{className:(0,i.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(x,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=l.JU.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(l.q7,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsx)(l.p4,{children:r})]})});h.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.wv.displayName}}]);
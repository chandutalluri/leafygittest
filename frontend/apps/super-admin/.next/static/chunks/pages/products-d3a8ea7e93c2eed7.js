(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4268],{2135:(e,s,t)=>{"use strict";t.d(s,{T:()=>c});var a=t(72),l=t(4),r=t(4018);let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});c.displayName="Textarea"},2489:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5935).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5088:(e,s,t)=>{"use strict";t.r(s),t.d(s,{__N_SSP:()=>I,default:()=>_});var a=t(72),l=t(4),r=t(1722),c=t(4960),n=t(347),i=t(3413),o=t(1703),d=t(4206),x=t(5814),h=t(5935);let m=(0,h.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),u=(0,h.A)("tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);var j=t(402),p=t(6383),g=t(5611),y=t(163),v=t(9825);t(2135);var f=t(7937),N=t(4230),b=t(4555),w=t(2489),k=t(8443),S=t(7101);function C(){var e;let[s,t]=(0,l.useState)([]),[r,c]=(0,l.useState)([]),[h,u]=(0,l.useState)(null),[g,N]=(0,l.useState)(!0),[C,A]=(0,l.useState)(""),[I,_]=(0,l.useState)("all"),[B,E]=(0,l.useState)("all"),[L,Z]=(0,l.useState)("all"),[T,F]=(0,l.useState)(null),[R,z]=(0,l.useState)(!1),[U,P]=(0,l.useState)(!1),[q,W]=(0,l.useState)({productId:0,adjustmentType:"increase",quantity:0,reason:"",newStock:0});(0,l.useEffect)(()=>{M()},[C,I,B,L]);let M=async()=>{try{N(!0);let[e,s,a]=await Promise.all([fetch("/api/inventory",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),fetch("/api/branches",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),fetch("/api/inventory/summary",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})]);if(e.ok){let s=await e.json();console.log("Inventory data received:",s),t(s.data||s||[])}if(s.ok){let e=await s.json();console.log("Branches data received:",e),c(e.data||e||[])}if(a.ok){let e=await a.json();console.log("Summary API Response:",e),u(e.data||null)}}catch(e){console.error("Failed to fetch inventory data:",e)}finally{N(!1)}},J=async(e,s,t)=>{try{console.log("Updating inventory for product:",e,"new stock:",s);let a=await fetch("/api/inventory/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({stockLevel:s,reason:t||"Manual adjustment"})});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to update inventory")}return console.log("Inventory updated successfully"),await M(),!0}catch(e){return console.error("Failed to update inventory:",e),alert("Failed to update inventory: "+(e instanceof Error?e.message:"Unknown error")),!1}},$=async(e,s,t)=>{try{console.log("Updating stock settings for product:",e);let a=await fetch("/api/inventory/".concat(e,"/settings"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({reorderLevel:s,maxStock:t})});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to update stock settings")}return console.log("Stock settings updated successfully"),await M(),z(!1),F(null),!0}catch(e){return console.error("Failed to update stock settings:",e),alert("Failed to update settings: "+(e instanceof Error?e.message:"Unknown error")),!1}},O=async()=>{try{let e="increase"===q.adjustmentType?q.newStock+q.quantity:q.newStock-q.quantity;if(e<0)return void alert("Stock cannot be negative");await J(q.productId,e,"".concat(q.adjustmentType.toUpperCase(),": ").concat(q.quantity," units - ").concat(q.reason))&&(P(!1),W({productId:0,adjustmentType:"increase",quantity:0,reason:"",newStock:0}))}catch(e){console.error("Failed to make stock adjustment:",e),alert("Failed to adjust stock: "+(e instanceof Error?e.message:"Unknown error"))}},V=async(e,s)=>{try{if(!confirm('Are you sure you want to delete "'.concat(s,'"? This action cannot be undone.')))return;console.log("Deleting product:",e);let t=await fetch("/api/products/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete product")}console.log("Product deleted successfully"),await M()}catch(e){console.error("Failed to delete product:",e),alert("Failed to delete product: "+(e instanceof Error?e.message:"Unknown error"))}},D=Array.from(new Set(s.map(e=>e.categoryName).filter(Boolean))),H=s.filter(e=>{let s=e.productName.toLowerCase().includes(C.toLowerCase())||e.sku.toLowerCase().includes(C.toLowerCase()),t="all"===I||e.branchId.toString()===I,a="all"===L||e.categoryName===L,l="normal";0===e.currentStock?l="out_of_stock":e.currentStock<=.5*e.reorderLevel?l="critical":e.currentStock<=e.reorderLevel&&(l="low");let r="all"===B||l===B;return s&&t&&a&&r});return g?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:"Loading Inventory Management..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Management Center"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Real-time inventory tracking for trading operations"})]})}),h&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total SKUs"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:h.total_skus})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total Units"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:h.total_units})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Low Stock"}),(0,a.jsx)(m,{className:"h-4 w-4 text-yellow-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:h.low_stock_count})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Critical"}),(0,a.jsx)(m,{className:"h-4 w-4 text-red-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:h.critical_stock_count})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Out of Stock"}),(0,a.jsx)(m,{className:"h-4 w-4 text-red-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:h.out_of_stock_count})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total Value"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-purple-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:["₹",h.total_value]})})]})]}),(0,a.jsxs)(n.Zp,{className:"bg-white shadow-sm border border-gray-200",children:[(0,a.jsx)(n.aR,{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2 text-gray-900",children:[(0,a.jsx)(j.A,{className:"h-5 w-5 text-blue-600"}),"Search & Filters"]})}),(0,a.jsxs)(n.Wu,{className:"p-6 bg-white",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"search",className:"text-sm font-medium text-gray-700",children:"Search Products"}),(0,a.jsx)(o.p,{placeholder:"Search products or SKU...",value:C,onChange:e=>A(e.target.value),className:"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"branch",className:"text-sm font-medium text-gray-700",children:"Branch"}),(0,a.jsxs)(f.l6,{value:I,onValueChange:_,children:[(0,a.jsx)(f.bq,{className:"bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500",children:(0,a.jsx)(f.yv,{placeholder:"All Branches"})}),(0,a.jsxs)(f.gC,{className:"bg-white border border-gray-200 shadow-lg",style:{zIndex:9999},children:[(0,a.jsx)(f.eb,{value:"all",className:"text-gray-900 hover:bg-gray-100",children:"All Branches"}),r.map(e=>(0,a.jsx)(f.eb,{value:e.id.toString(),className:"text-gray-900 hover:bg-gray-100",children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"category",className:"text-sm font-medium text-gray-700",children:"Category"}),(0,a.jsxs)(f.l6,{value:L,onValueChange:Z,children:[(0,a.jsx)(f.bq,{className:"bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500",children:(0,a.jsx)(f.yv,{placeholder:"All Categories"})}),(0,a.jsxs)(f.gC,{className:"bg-white border border-gray-200 shadow-lg",style:{zIndex:9999},children:[(0,a.jsx)(f.eb,{value:"all",className:"text-gray-900 hover:bg-gray-100",children:"All Categories"}),D.map(e=>(0,a.jsx)(f.eb,{value:e,className:"text-gray-900 hover:bg-gray-100",children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"status",className:"text-sm font-medium text-gray-700",children:"Stock Status"}),(0,a.jsxs)(f.l6,{value:B,onValueChange:E,children:[(0,a.jsx)(f.bq,{className:"bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500",children:(0,a.jsx)(f.yv,{placeholder:"All Status"})}),(0,a.jsxs)(f.gC,{className:"bg-white border border-gray-200 shadow-lg",style:{zIndex:9999},children:[(0,a.jsx)(f.eb,{value:"all",className:"text-gray-900 hover:bg-gray-100",children:"All Status"}),(0,a.jsx)(f.eb,{value:"normal",className:"text-gray-900 hover:bg-gray-100",children:"Normal Stock"}),(0,a.jsx)(f.eb,{value:"low",className:"text-gray-900 hover:bg-gray-100",children:"Low Stock"}),(0,a.jsx)(f.eb,{value:"critical",className:"text-gray-900 hover:bg-gray-100",children:"Critical Stock"}),(0,a.jsx)(f.eb,{value:"out_of_stock",className:"text-gray-900 hover:bg-gray-100",children:"Out of Stock"})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[C&&(0,a.jsxs)(d.E,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:['Search: "',C,'"',(0,a.jsx)("button",{onClick:()=>A(""),className:"ml-2 text-blue-600 hover:text-blue-800",children:"\xd7"})]}),"all"!==I&&(0,a.jsxs)(d.E,{variant:"secondary",className:"bg-green-100 text-green-800",children:["Branch: ",null==(e=r.find(e=>e.id.toString()===I))?void 0:e.name,(0,a.jsx)("button",{onClick:()=>_("all"),className:"ml-2 text-green-600 hover:text-green-800",children:"\xd7"})]}),"all"!==L&&(0,a.jsxs)(d.E,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:["Category: ",L,(0,a.jsx)("button",{onClick:()=>Z("all"),className:"ml-2 text-purple-600 hover:text-purple-800",children:"\xd7"})]}),"all"!==B&&(0,a.jsxs)(d.E,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:["Status: ",B.replace("_"," "),(0,a.jsx)("button",{onClick:()=>E("all"),className:"ml-2 text-orange-600 hover:text-orange-800",children:"\xd7"})]})]})]})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{children:["Inventory Items (",H.length,")"]})}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Product"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Branch"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"SKU"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Stock"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Reorder Level"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Value"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:H.map((e,s)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.productName}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.categoryName||"No Category"})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(d.E,{variant:"secondary",children:e.branchName})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:e.sku})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:e.currentStock<=e.reorderLevel?"text-red-600 font-bold":"",children:e.currentStock}),e.currentStock<=e.reorderLevel&&(0,a.jsx)(m,{className:"h-4 w-4 text-yellow-500"})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.reorderLevel}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(d.E,{variant:(e=>{switch(e){case"normal":default:return"default";case"low":return"secondary";case"critical":case"out_of_stock":return"destructive"}})(e.stockStatus),children:e.stockStatus.replace("_"," ").toUpperCase()})}),(0,a.jsxs)("td",{className:"py-3 px-4",children:["₹",e.stockValue]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{W({productId:e.productId,adjustmentType:"increase",quantity:0,reason:"",newStock:e.currentStock}),P(!0)},children:[(0,a.jsx)(w.A,{className:"h-4 w-4 mr-1"}),"Adjust"]}),(0,a.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{F(e),z(!0)},children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Settings"]}),(0,a.jsx)(i.$,{size:"sm",variant:"outline",onClick:()=>J(e.productId,e.reorderLevel+50,"Quick restock"),children:"Restock"}),(0,a.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>V(e.productId,e.productName),className:"text-red-600 hover:text-red-800 hover:bg-red-50",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},"".concat(e.productId,"-").concat(e.branchId,"-").concat(s)))})]}),0===H.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No inventory items found matching your filters."})]})})]}),(0,a.jsx)(S.lG,{open:U,onOpenChange:P,children:(0,a.jsxs)(S.Cf,{className:"max-w-md",children:[(0,a.jsx)(S.c7,{children:(0,a.jsx)(S.L3,{children:"Stock Adjustment"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Current Stock"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:q.newStock})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Adjustment Type"}),(0,a.jsxs)(f.l6,{value:q.adjustmentType,onValueChange:e=>W({...q,adjustmentType:e}),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"increase",children:"Increase Stock"}),(0,a.jsx)(f.eb,{value:"decrease",children:"Decrease Stock"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Quantity"}),(0,a.jsx)(o.p,{type:"number",value:q.quantity,onChange:e=>W({...q,quantity:parseInt(e.target.value)||0})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Reason"}),(0,a.jsx)(o.p,{value:q.reason,onChange:e=>W({...q,reason:e.target.value}),placeholder:"Reason for adjustment..."})]}),(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"New Stock Level:"}),(0,a.jsx)("div",{className:"text-xl font-bold",children:"increase"===q.adjustmentType?q.newStock+q.quantity:q.newStock-q.quantity})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,a.jsxs)(i.$,{onClick:O,children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Apply Adjustment"]})]})]})]})}),(0,a.jsx)(S.lG,{open:R,onOpenChange:z,children:(0,a.jsxs)(S.Cf,{className:"max-w-md",children:[(0,a.jsx)(S.c7,{children:(0,a.jsxs)(S.L3,{children:["Stock Settings: ",null==T?void 0:T.productName]})}),T&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Reorder Level"}),(0,a.jsx)(o.p,{type:"number",value:T.reorderLevel,onChange:e=>{let s=parseInt(e.target.value)||0;F({...T,reorderLevel:s})}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"Maximum Stock"}),(0,a.jsx)(o.p,{type:"number",value:T.maxStock,onChange:e=>{let s=parseInt(e.target.value)||0;F({...T,maxStock:s})}})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(i.$,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),(0,a.jsxs)(i.$,{onClick:()=>$(T.productId,T.reorderLevel,T.maxStock),children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Update Settings"]})]})]})]})})]})}function A(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)([]),[h,v]=(0,l.useState)([]),[b,w]=(0,l.useState)(!0),[k,S]=(0,l.useState)("overview"),[A,I]=(0,l.useState)(""),[_,B]=(0,l.useState)("all"),[E,L]=(0,l.useState)("all"),[Z,T]=(0,l.useState)(!1);(0,l.useEffect)(()=>{F()},[A,_,E]);let F=async()=>{try{w(!0);let[e,t,a]=await Promise.all([c.uE.get("/api/direct-data/products",{search:A,category:"all"!==_?_:void 0,status:"all"!==E?E:void 0}),c.uE.get("/api/direct-data/categories"),c.uE.get("/api/direct-data/inventory/alerts")]);s(e||[]),r(t||[]),v(a||[])}catch(e){console.error("Failed to fetch product ecosystem data:",e)}finally{w(!1)}},R=async(e,s)=>{try{console.log("Updating inventory for product:",e,"new stock:",s);let t=await fetch("/api/inventory/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({stockLevel:s})});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to update inventory")}console.log("Inventory updated successfully"),await F()}catch(e){console.error("Failed to update inventory:",e),alert("Failed to update inventory: "+(e instanceof Error?e.message:"Unknown error"))}},z=async(e,s)=>{try{console.log("Uploading image for product:",e);let t=new FormData;t.append("files",s),t.append("entityType","product"),t.append("entityId",e);let a=await fetch("/api/image-management/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:t});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to upload image")}console.log("Image uploaded successfully"),await F()}catch(e){console.error("Failed to upload product image:",e),alert("Failed to upload image: "+(e instanceof Error?e.message:"Unknown error"))}},U=e.filter(e=>e.name.toLowerCase().includes(A.toLowerCase())||e.description.toLowerCase().includes(A.toLowerCase())),P=e.length,q=e.filter(e=>"active"===e.status).length,W=e.filter(e=>e.stockLevel<=e.lowStockThreshold).length,M=t.length;return b?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:"Loading Product Ecosystem..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Product Ecosystem"}),(0,a.jsx)("p",{className:"text-gray-500",children:'Complete product lifecycle management - Use sidebar "Add Product" to create new products'})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total Products"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:P})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Active Products"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:q})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Low Stock Items"}),(0,a.jsx)(m,{className:"h-4 w-4 text-yellow-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:W})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Categories"}),(0,a.jsx)(u,{className:"h-4 w-4 text-purple-500"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:M})})]})]}),h.length>0&&(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(m,{className:"h-4 w-4 text-yellow-500"}),"Stock Alerts"]}),(0,a.jsx)(n.BT,{children:"Products requiring immediate attention"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:h.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.productName}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.branchName})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(d.E,{variant:(e=>{switch(e){case"critical":case"out_of_stock":return"destructive";case"low":return"secondary";default:return"default"}})(e.severity),children:[e.currentStock," / ",e.threshold]}),(0,a.jsx)(i.$,{size:"sm",onClick:()=>R(e.productId,e.threshold+50),children:"Restock"})]})]},e.id))})})]}),(0,a.jsx)("div",{className:"flex space-x-4 border-b",children:["overview","products","inventory","categories","images"].map(e=>(0,a.jsx)("button",{onClick:()=>S(e),className:"pb-2 px-1 border-b-2 font-medium text-sm capitalize ".concat(k===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:e},e))}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),"Search & Filters"]})}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(o.p,{placeholder:"Search products...",value:A,onChange:e=>I(e.target.value)}),(0,a.jsxs)(f.l6,{value:_,onValueChange:B,children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Filter by category"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Categories"}),t.map(e=>(0,a.jsx)(f.eb,{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)(f.l6,{value:E,onValueChange:L,children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Status"}),(0,a.jsx)(f.eb,{value:"active",children:"Active"}),(0,a.jsx)(f.eb,{value:"inactive",children:"Inactive"}),(0,a.jsx)(f.eb,{value:"out_of_stock",children:"Out of Stock"})]})]})]})})]}),"products"===k&&(0,a.jsx)(N.A,{}),"inventory"===k&&(0,a.jsx)(C,{}),"categories"===k&&(0,a.jsxs)(n.Zp,{children:[(0,a.jsx)(n.aR,{children:(0,a.jsx)(n.ZB,{children:"Category Management"})}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Product"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Category"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Price"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Stock"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Branch"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:U.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.images.length>0&&(0,a.jsx)("img",{src:e.images[0],alt:e.name,className:"w-10 h-10 rounded-lg object-cover"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:e.description})]})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(d.E,{variant:"secondary",children:e.category})}),(0,a.jsxs)("td",{className:"py-3 px-4",children:["₹",e.price]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:e.stockLevel<=e.lowStockThreshold?"text-red-600":"",children:e.stockLevel}),e.stockLevel<=e.lowStockThreshold&&(0,a.jsx)(m,{className:"h-4 w-4 text-yellow-500"})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(d.E,{variant:(e=>{switch(e){case"active":default:return"default";case"inactive":return"secondary";case"out_of_stock":return"destructive"}})(e.status),children:e.status.replace("_"," ").toUpperCase()})}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.branchName}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.$,{size:"sm",variant:"outline",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:s=>{var t;let a=null==(t=s.target.files)?void 0:t[0];a&&z(e.id,a)},className:"hidden",id:"image-".concat(e.id)}),(0,a.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{var s;return null==(s=document.getElementById("image-".concat(e.id)))?void 0:s.click()},children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-1"}),"Image"]})]})})]},e.id))})]})})})]}),"categories"===k&&(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Category Management"}),(0,a.jsx)(n.BT,{children:"Organize products into categories and hierarchies"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{className:"text-lg",children:e.name}),(0,a.jsx)(n.BT,{children:e.description})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.productCount," products"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.$,{size:"sm",variant:"outline",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.$,{size:"sm",variant:"outline",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})]})})]},e.id))})})]})]})}var I=!0;function _(){return(0,a.jsx)(r.A,{children:(0,a.jsx)(A,{})})}},7616:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/products",function(){return t(5088)}])},8443:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(5935).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])}},e=>{e.O(0,[9257,4449,2397,8885,6790,4230,6966,636,6593,8792],()=>e(e.s=7616)),_N_E=e.O()}]);